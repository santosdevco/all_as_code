# üîç Prompt de An√°lisis - Documentaci√≥n de Deployment e Infraestructura

## ROL
Eres un **Senior DevOps Architect y Site Reliability Engineer** experto en an√°lisis de infraestructura cloud-native.

## CONTEXTO
Vas a analizar el proyecto actual (`@workspace`) para documentar la arquitectura de **deployment, CI/CD y monitoreo**.

## OBJETIVO
1. **Analizar** el workspace exhaustivamente
2. **Reportar** hallazgos en consola (NO generar archivos)
3. **Generar** YAML con preguntas categorizadas en 3 niveles:
   - ‚úÖ **YA_SABEMOS**: Informaci√≥n encontrada con certeza
   - ‚ö†Ô∏è **VALIDAR**: Informaci√≥n parcial que requiere confirmaci√≥n
   - ‚ùì **NO_SABEMOS**: Informaci√≥n que no est√° en el c√≥digo

## ARCHIVOS DE SALIDA A GENERAR (en siguiente prompt)
- `ai_docs/06-infraestructura/01-deployment.md`
- `ai_docs/06-infraestructura/02-ci-cd.md`
- `ai_docs/06-infraestructura/03-monitoreo.md`

---

## PASO 1: Analizar el Proyecto Completo

Examina minuciosamente el workspace (@workspace) buscando:

### üê≥ Contenedorizaci√≥n
- [ ] ¬øHay **Dockerfile**? ‚Üí Analiza: imagen base, puertos, ENV vars, comandos
- [ ] ¬øHay **docker-compose.yml**? ‚Üí Analiza: servicios, vol√∫menes, networks, ports
- [ ] ¬øDocker en m√∫ltiples ambientes? ‚Üí Busca: Dockerfile.dev, Dockerfile.prod

### ‚òÅÔ∏è Cloud Provider
- [ ] **AWS** ‚Üí Busca: cloudformation/, terraform/ con provider aws, .aws/
- [ ] **IBM Cloud** ‚Üí Busca: ibmcloud.yml, manifest.yml, .bluemix/
- [ ] **GCP** ‚Üí Busca: app.yaml, cloudbuild.yaml, terraform/ con provider google
- [ ] **Azure** ‚Üí Busca: bicep/, terraform/ con provider azurerm

### ‚ò∏Ô∏è Orquestaci√≥n
- [ ] **Kubernetes** ‚Üí Busca: k8s/, kubernetes/, manifests/, charts/, deployment.yaml
- [ ] **Helm Charts** ‚Üí Busca: charts/, Chart.yaml, values.yaml
- [ ] **Kustomize** ‚Üí Busca: kustomization.yaml

### üîÑ CI/CD
- [ ] **GitHub Actions** ‚Üí .github/workflows/*.yml
- [ ] **GitLab CI** ‚Üí .gitlab-ci.yml
- [ ] **Jenkins** ‚Üí Jenkinsfile
- [ ] **CircleCI** ‚Üí .circleci/config.yml
- [ ] **Travis** ‚Üí .travis.yml
- [ ] **Azure DevOps** ‚Üí azure-pipelines.yml
- [ ] **IBM Toolchain** ‚Üí .bluemix/toolchain.yml

### üìä Monitoreo
- [ ] **Prometheus** ‚Üí prometheus.yml, ServiceMonitor
- [ ] **Grafana** ‚Üí dashboards/, grafana/
- [ ] **Datadog** ‚Üí datadog.yaml, DD_API_KEY
- [ ] **New Relic** ‚Üí newrelic.yml, NEW_RELIC_LICENSE_KEY
- [ ] **CloudWatch** ‚Üí Referencias en c√≥digo
- [ ] **Sentry** ‚Üí sentry.properties, SENTRY_DSN

### üóÑÔ∏è Base de Datos
- [ ] **Tipo de BD** ‚Üí Analiza: package.json, requirements.txt, pom.xml
- [ ] **ORM/ODM** ‚Üí Busca: prisma/, TypeORM, sequelize, mongoose, sqlalchemy
- [ ] **Migraciones** ‚Üí Busca: migrations/, alembic/, flyway/
- [ ] **Conexi√≥n** ‚Üí Analiza variables de entorno, config files

### üåç Ambientes
- [ ] **.env files** ‚Üí .env.example, .env.development, .env.production
- [ ] **Config files** ‚Üí config/development.js, config/production.js
- [ ] **Secrets** ‚Üí Referencias a secrets managers (AWS Secrets, IBM Key Protect)

---

## PASO 2: Clasificar la Informaci√≥n

Para cada aspecto, clasifica como:

### ‚úÖ ENCONTRADO (certeza alta)
- Hay evidencia clara en el c√≥digo
- Puedes extraer valores concretos
- **NO generar pregunta** - Incluir directamente en el template

### ‚ö†Ô∏è PARCIAL (certeza media)
- Hay indicios pero faltan detalles
- Generar pregunta con opciones limitadas
- Pre-llenar con lo que encontraste

### ‚ùå NO ENCONTRADO (certeza baja)
- No hay evidencia en el c√≥digo
- Requiere conocimiento del equipo
- **Generar pregunta completa**

---

## PASO 3: Generar el Archivo YAML

Genera un YAML con esta estructura EXACTA:

```yaml
# ============================================
# CUESTIONARIO GENERADO AUTOM√ÅTICAMENTE
# Proyecto: [NOMBRE_DETECTADO]
# ============================================

title: "üöÄ Deployment - [NOMBRE_PROYECTO]"
description: "Completa la informaci√≥n faltante para generar documentaci√≥n completa."

# ============================================
# TEMPLATE PRE-LLENADO
# ============================================
# Esta secci√≥n contiene TODA la informaci√≥n
# extra√≠da autom√°ticamente del c√≥digo
# ============================================

template: |
  # ROL
  Eres un DevOps Engineer documentando infraestructura.

  # PROYECTO ANALIZADO
  **Nombre**: [nombre del proyecto]
  **Tipo**: [web app / api / microservicio / etc]
  **Lenguaje**: [detectado]

  # ‚úÖ INFORMACI√ìN EXTRA√çDA DEL C√ìDIGO

  ## üê≥ Docker
  [SI ENCONTRASTE DOCKERFILE:]
  - **Dockerfile**: ‚úì Encontrado
  - **Imagen Base**: `[extraer FROM]`
  - **Puertos**: `[extraer EXPOSE]`
  - **Comando**: `[extraer CMD/ENTRYPOINT]`
  
  [SI ENCONTRASTE DOCKER-COMPOSE:]
  - **Docker Compose**: ‚úì Encontrado
  - **Servicios**: [listar servicios]
  
  [SI NO ENCONTRASTE DOCKER:]
  - **Docker**: ‚úó No detectado

  ## üîÑ CI/CD
  [SI ENCONTRASTE CI/CD:]
  - **Herramienta**: [GitHub Actions / GitLab CI / etc]
  - **Archivo**: `[ruta]`
  - **Stages**: [build, test, deploy, etc]
  
  **[INSTRUCCI√ìN PARA COPILOT]**:
  Analiza el archivo `[ruta]` y documenta en detalle:
  - Cada stage del pipeline
  - Comandos ejecutados
  - Triggers
  - Variables de entorno
  
  [SI NO ENCONTRASTE:]
  - **CI/CD**: ‚úó No detectado

  ## üóÑÔ∏è Base de Datos
  [SI ENCONTRASTE:]
  - **Tipo**: [PostgreSQL / MySQL / MongoDB]
  - **ORM**: [Prisma / TypeORM / etc]
  - **Migraciones**: [ubicaci√≥n]
  
  [SI NO:]
  - **Base de Datos**: ‚úó No detectada

  ## üìä Monitoreo
  [SI ENCONTRASTE:]
  - **Herramientas**: [Prometheus, Datadog, etc]
  
  [SI NO:]
  - **Monitoreo**: ‚úó No detectado

  # ‚ùå INFORMACI√ìN PROPORCIONADA POR EL USUARIO
  
  Las siguientes preguntas NO pudieron ser respondidas del c√≥digo:
  
  {{#cada_pregunta}}
  - **{{pregunta}}**: {{respuesta_usuario}}
  {{/cada}}

  # üéØ TAREA FINAL

  Genera estos 3 archivos en Markdown:

  ## 1. ai_docs/06-infraestructura/01-deployment.md
  - Diagrama de arquitectura (Mermaid)
  - Configuraci√≥n de ambientes
  - Proceso de deployment
  - Escalabilidad

  ## 2. ai_docs/06-infraestructura/02-ci-cd.md
  - Diagrama del pipeline (Mermaid)
  - Descripci√≥n de stages
  - Triggers y condiciones
  - Secrets

  ## 3. ai_docs/06-infraestructura/03-monitoreo.md
  - Herramientas configuradas
  - M√©tricas clave
  - Dashboards
  - Alertas

# ============================================
# PREGUNTAS (SOLO LO NO ENCONTRADO)
# ============================================

sections:
  # Solo incluir secciones necesarias
  
  [EJEMPLO - SI NO ENCONTRASTE CLOUD PROVIDER:]
  - icon: "‚òÅÔ∏è"
    title: "Cloud Provider"
    description: "No se detect√≥ cloud provider en el c√≥digo"
    questions:
      - id: cloudProvider
        type: checkbox
        label: "¬øQu√© cloud providers usa?"
        options:
          - value: aws
            label: "AWS"
          - value: ibm
            label: "IBM Cloud"
          - value: gcp
            label: "GCP"
          - value: azure
            label: "Azure"

  [EJEMPLO - SI ENCONTRASTE DOCKER PERO NO PLATAFORMA:]
  - icon: "üöÄ"
    title: "Plataforma de Deployment"
    description: "Se detect√≥ Docker pero no la plataforma"
    questions:
      - id: deployPlatform
        type: select
        label: "¬øD√≥nde se despliega en producci√≥n?"
        options:
          - value: kubernetes
            label: "Kubernetes"
          - value: ecs
            label: "AWS ECS"
          - value: cloud-run
            label: "Google Cloud Run"
```

---

## REGLAS CR√çTICAS

1. **Maximiza la extracci√≥n** - Incluye TODA la info que puedas del c√≥digo en `template`
2. **Minimiza preguntas** - Solo pregunta lo IMPOSIBLE de determinar
3. **S√© espec√≠fico** - Copia configs relevantes, no solo digas "existe"
4. **Marca incertidumbres** - Si no est√°s seguro, genera pregunta
5. **Instrucciones claras** - En template, di a Copilot qu√© analizar despu√©s

---

## OUTPUT FINAL

Genera el YAML completo en la terminal con:
- ‚úÖ `template:` lleno con TODA la info extra√≠da
- ‚ùå `sections:` con SOLO preguntas cr√≠ticas faltantes
- üìù Formato correcto YAML

**El usuario copiar√° este YAML y lo pegar√° en el formulario web.**
